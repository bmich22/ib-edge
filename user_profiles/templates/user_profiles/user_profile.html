{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <h2>My Profile</h2>
    {% if show_form %}
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">Save Changes</button>

    {% if is_editing %}
      <a href="{% url 'user_profile' %}" class="btn btn-secondary">Cancel</a>
    {% endif %}
  </form>
{% else %}
  <p>Your profile is up to date.</p>
{% endif %}
<hr>
<!-- <h4 class="mt-4">Welcome, {{ user.first_name|default:user.username }}!</h4> -->

{% if purchases %}
  <h4 class="mt-4">Your Tutoring Packages</h4>
  {% for purchase in purchases %}
    <div class="border p-3 mb-3 rounded">
      <p><strong>Package:</strong> {{ purchase.package.name }}</p>
      <p><strong>Purchased On:</strong> {{ purchase.purchased_on|date:"F j, Y" }}</p>
      <p><strong>Expires On:</strong> {{ purchase.expires_on|date:"F j, Y" }}</p>
      <p><strong>Sessions Purchased:</strong> {{ purchase.package.num_sessions }}</p>
      <p><strong>Sessions Used:</strong> {{ purchase.sessions_used }}</p>
      <p><strong>Sessions Remaining:</strong> {{ purchase.sessions_remaining }}</p>
    </div>
  {% endfor %}
{% else %}
  <p class="text-warning">You donâ€™t have a tutoring package yet.</p>
{% endif %}

<hr>
<p>Book your tutoring sessions here:</p>
{% if user.userprofile.sessions_remaining > 0 %}
<h5 class="mt-4">Book Your Next Session</h5>
    <a href="https://calendly.com/" class="btn btn-outline-primary" target="_blank">
        Link to Tutor's schedule
    </a>
{% else %}
    <p class="text-muted">You have 0 sessions. </p>
{% endif %}
</div>
{% endblock %}